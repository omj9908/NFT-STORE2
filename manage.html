<!DOCTYPE html>
<html lang="en">
<head> 
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT ê´€ë¦¬</title>

    <style>
        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            width: 100%;
            height: 80px;
        }

        header > div {
            text-align: center;
            padding-top: 20px;
            font-family: 'Merienda', cursive;
            font-size: 40px;
            font-weight: bold;
            color: black;
        }

        /* í‘¸í„° ìŠ¤íƒ€ì¼ */
        footer {   
            width: 100%;
            height: 100px;
            border-top: 2px double black;
        }

        footer > div {
            text-align: center;
            font-family: 'Times New Roman';
            font-size: 12px;
            padding: 15px;
        }
    </style>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Web3.js -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>

<header class="bg-info">
    <div>NFT ê´€ë¦¬</div>
</header>

<!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” ì¶”ê°€ -->
<nav class="navbar navbar-expand-md bg-info">
    <div class="container my-0">
        <a class="navbar-brand" href="#">NFT</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#myMenuTop">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="myMenuTop">
            <ul class="navbar-nav me-auto mb-0">
                <li class="nav-item">
                    <a class="nav-link" href="listing.html">íŒë§¤ì¤‘</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="minting.html">ë¯¼íŒ…</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="manage.html">ê´€ë¦¬</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<main class="container my-5">
    <h2 class="mt-4">ë‚´ NFT ëª©ë¡</h2>
    <button class="btn btn-success mb-3" onclick="loadMyNFTs()">ë‚´ NFT ë¶ˆëŸ¬ì˜¤ê¸°</button>
    <p id="status"></p>

    <!-- NFT ëª©ë¡ì´ í‘œì‹œë  ì»¨í…Œì´ë„ˆ -->
    <div class="row" id="nftContainer"></div>
</main>

<!-- âœ… NFT ì´ë¦„ ë³€ê²½ ëª¨ë‹¬ ì¶”ê°€ -->
<div class="modal fade" id="nameChangeModal" tabindex="-1" aria-labelledby="nameChangeModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="nameChangeModalLabel">NFT ì´ë¦„ ë³€ê²½</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="modalTokenId">
                <label for="newNFTName">ìƒˆë¡œìš´ NFT ì´ë¦„:</label>
                <input type="text" id="newNFTName" class="form-control" placeholder="ìƒˆ NFT ì´ë¦„ ì…ë ¥">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                <button type="button" class="btn btn-primary" onclick="confirmNameChange()">ë³€ê²½</button>
            </div>
        </div>
    </div>
</div>

<footer class="footer" style="margin-top: 30px">
    <div>ëª»ìƒê¸´ ê³ ë¦´ë¼ ì²˜ëŸ¼ ğŸ’™</div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Web3.js -->
<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
<!-- JS ì½”ë“œ -->
<script src="./js/manage.js"></script>

<script>
    // âœ… NFT ì´ë¦„ ë³€ê²½ ëª¨ë‹¬ ì—´ê¸°
    function openNameChangeModal(tokenId) {
        document.getElementById("modalTokenId").value = tokenId;
        document.getElementById("newNFTName").value = "";
        const nameChangeModal = new bootstrap.Modal(document.getElementById("nameChangeModal"));
        nameChangeModal.show();
    }

    // âœ… NFT ì´ë¦„ ë³€ê²½ ì‹¤í–‰
    async function confirmNameChange() {
        const tokenId = document.getElementById("modalTokenId").value;
        const newName = document.getElementById("newNFTName").value;

        if (!newName) {
            alert("NFT ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!");
            return;
        }

        try {
            await changeNFTName(tokenId, newName);
            alert(`NFT #${tokenId}ì˜ ì´ë¦„ì´ "${newName}"ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            loadMyNFTs(); // ìƒˆë¡œê³ ì¹¨
        } catch (error) {
            console.error("âŒ NFT ì´ë¦„ ë³€ê²½ ì˜¤ë¥˜:", error);
            alert("NFT ì´ë¦„ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }
</script>

</body>
</html>
